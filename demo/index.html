<!doctype html>
<html lang="en-GB">
<head>
  <meta charset="utf-8">
  <style>
    body {
      background: #fafafa;
    }
    table {
      border-collapse: collapse;
      border-color: #dee2e6;
    }
    tbody, td, tfoot, th, thead, tr {
      border-color: inherit;
      border-style: solid;
      border-width: 0;
    }
    table > :not(caption) > * > * {
      padding: 1rem 1rem;
      border-bottom-width: 1px;
      border-right-width: 1px;
    }
  </style>
</head>
<body>
  <div id="demo"></div>

  <script type="module">
    import { html, render } from 'lit';
    import '../render-rev.js';

    const debug = true;
    const docmapsUrl = doi => `http://localhost:5050/api/v2/docmap/${doi}`;

    const eebDois = [
      '10.1101/2022.07.22.22277924',
      '10.1101/2021.10.26.465695',
      '10.1101/2020.05.15.098251',
      '10.1101/452276',
      '10.1101/2022.07.14.499766',
    ];
    const scietyDois = [
      '10.21203/rs.3.rs-955726',
    ];

    render(
      html`
        <table>
          <tbody>
            ${eebDois.map((doi, idx) => html`
              <tr>
                ${idx === 0 ? html`
                  <th rowspan="${eebDois.length}" scope="row">
                    Fetched from EEB
                  </th>
                ` : null}
                <td>
                  <h5>${doi}:</h5>
                  <render-rev data-doi="${doi}"></render-rev>
                </td>
              </tr>
            `)}

            ${scietyDois.map((doi, idx) => html`
              <tr>
                ${idx === 0 ? html`
                  <th rowspan="${scietyDois.length}" scope="row">
                    Sciety-style docmaps
                  </th>
                ` : null}
                <td>
                  <span>${doi}:</span>
                  <render-rev class="sciety-docmaps" data-doi="${doi}"></render-rev>
                </td>
              </tr>
            `)}
          </tbody>
        </table>
      `,
      document.querySelector('#demo')
    );

    eebDois.forEach(
      doi => document.querySelector(`render-rev[data-doi="${doi}"]`).configure({ docmapsUrl, doi, debug })
    );
    scietyDois.forEach(
      doi => fetch(`sciety-docmaps/${doi}.json`)
        .then(data => data.json())
        .then(docmaps => document.querySelector(`render-rev.sciety-docmaps[data-doi="${doi}"]`).configure({ debug, docmaps }))
    );
  </script>
</body>
</html>
